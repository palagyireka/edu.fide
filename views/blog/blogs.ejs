<% layout('layouts/boilerplate') %>
<main class="blogs">
  <div class="posts-title">
    <p>Blogposts</p>
    <span>
      Chronological order:
      <select name="chrorder" id="chrorder">
        <option value="latest">Latest</option>
        <option value="earliest">Earliest</option>
      </select>
    </span>
  </div>
  <div id="b-posts">
    <% blogposts.forEach((blog) => {%>
    <a class="blog-card" href="/blog/<%= blog.id %>">
      <div class="tag-names"></div>
      <h2>
        <!-- style="background-image: url('<%= blog.image[0].url %>')" -->
        <%= blog.title %>
      </h2>
      <p><%= blog.text %> <br /></p>
      <span> Read more here >> </span>
    </a>
    <% }) %>
  </div>
  <a href="/blog">First</a>
  <a href="/blog?page=<%= pageNumber > 1 ? parseInt(pageNumber) - 1 : 1 %>"
    >Previous</a
  >
  <div class="page-counter"><%= pageNumber %></div>
  <a href="/blog?page=<%= parseInt(pageNumber)+ 1 %>">Next</a>
  <a href="/blog?page=<%= totalPages %>">Last</a>
</main>
<script src="/js/blog.js"></script>
<script>
  const bPosts = document.querySelector("#b-posts");
  const blogCards = document.querySelectorAll(".blog-card");
  let counter = 0;
  while (counter < blogCards.length) {
    const sor = document.createElement("div");
    sor.className = "blogsor";
    sor.appendChild(blogCards[counter]);
    if (counter + 1 != blogCards.length) {
      sor.appendChild(blogCards[counter + 1]);
    }
    if (counter + 2 != blogCards.length) {
      sor.appendChild(blogCards[counter + 2]);
    }
    bPosts.appendChild(sor);
    counter += 3;
  }

  const chrOrder = document.querySelector("#chrorder");
  chrOrder.addEventListener("click", (evt) => {
    console.log("fired");
    if (evt.target.selectedIndex == 1) {
      bPosts.style.flexDirection = "column-reverse";
    } else {
      bPosts.style.flexDirection = "column";
    }
  });
</script>

<!-- const blogCards = document.querySelectorAll(".blog-card");
  let cardCount = 0;
  const fibNums = [1, 2, 3, 5];
  const main = document.querySelector("main");
  // main.style.marginTop = "7vh";

  for (let i = 0; i < 4; i++) {
    const sor = document.createElement("div");
    sor.className = "blogsor";
    for (let f = 0; f < fibNums[i]; f++) {
      if (cardCount < 8) {
        blogCards[cardCount].style.width = `${100 / fibNums[i]}%`;
        sor.appendChild(blogCards[cardCount]);
        cardCount++;
      }
    }
    main.appendChild(sor);
  } -->
